# CodeGen - генерация и автоматическое тестирование программ

Этот проект представляет собой автоматизированный генератор Python-скриптов, который взаимодействует с моделью генерации текста для создания и отладки кода на основе входных хранящихся в файле (data.html) и выходных данных хранящихся в файле (data.json). Основные функции и логика программы:

## Основные компоненты:
1. **API для генерации текста**:
   - Используется библиотека `google.genai` для взаимодействия с моделью генерации текста.
   - `set_api_key(api_key)` — устанавливает API-ключ для клиента.
   - `generate_response(prompt)` — отправляет запрос (prompt) к модели и возвращает текстовый ответ.

2. **Работа с файлами**:
   - `read_file(file_path)` — читает содержимое файла.
   - `script_save(code)` — сохраняет сгенерированный код в файл `script.py`.
   - `requirements_save(requirements)` — сохраняет зависимости в файл requirements.txt.

3. **Генерация запросов (prompts)**:
   - `generate_prompt()` — создает запрос для генерации Python-кода и файла requirements.txt на основе входных (`data.html`) и выходных данных (`data.json`).
   - `generate_correction_prompt(script_code, error_message, actual_output)` — создает запрос для исправления сгенерированного кода, если он не работает корректно.

4. **Парсинг ответа от модели**:
   - `get_code(response)` — извлекает блоки Python-кода из ответа модели.
   - `get_requirements(response)` — извлекает блоки зависимостей (`requirements.txt`) из ответа модели.

5. **Docker**:
   - `docker_run()` — выполняет сборку Docker-образа и запускает контейнер с сгенерированным скриптом. Возвращает стандартный вывод и ошибки.

6. **Сравнение результатов**:
   - `compare_output(script_output, expected_output)` — сравнивает фактический вывод скрипта с ожидаемым.

7. **Git**:
   - `commit_changes()` — добавляет изменения в Git и создает коммит с фиксированным сообщением.

8. **Основной цикл программы**:
   - Функция `start(commit=False)`:
     - Генерирует запрос для создания кода и зависимостей.
     - Сохраняет сгенерированные файлы.
     - Запускает Docker-контейнер для выполнения кода.
     - Сравнивает вывод с ожидаемым. Если вывод не совпадает, отправляет запрос на исправление кода.
     - Повторяет процесс до тех пор, пока вывод не совпадет с ожидаемым.

9. **Точка входа**:
   - Если файл запускается напрямую, вызывается функция `start()`.

### Примечания:
- Код использует Docker для изоляции выполнения сгенерированного скрипта.
- В случае ошибок или несовпадения вывода программа автоматически генерирует исправления.
- Программа предполагает наличие файлов data.html и data.json для работы.
