 # CodeGen

**CodeGen** — это инструмент для автоматической генерации и корректировки Python-скриптов, который использует API модели [Ollama](https://ollama.ai/) для создания кода и файла зависимостей (`requirements.txt`) на основе заданных входных и выходных данных.

## Основные возможности

- **Генерация кода:**  
  Программа формирует запрос (prompt) для создания Python-скрипта, который читает входные данные из файла data.html и выводит результат в консоль, сравнивая его с ожидаемыми данными из data.json.

- **Использование Docker:**  
  Для выполнения сгенерированного кода используется Docker. Код собирается в Docker-образ и запускается контейнер, что позволяет изолировать выполнение скрипта.

- **Корректировка кода:**  
  При несовпадении фактического вывода с ожидаемым, программа автоматически запрашивает у модели исправление кода и повторно запускает его.

- **Интеграция с Git:**  
  При необходимости можно сохранить сгенерированные изменения в Git-репозитории (вызов функции `commit_changes()`).

- **Параметры командной строки:**  
  Название используемой модели Ollama, а также пути к файлам входных (`data.html`) и выходных данных (`data.json`) можно задавать через параметры командной строки:
  ```
  python CodeGen.py --model yandex/YandexGPT-5-Lite-8B-instruct-GGUF --input data.html --output data.json
  ```

## Структура проекта

- **CodeGen.py:**  
  Основной скрипт, который:
  - Считывает входные (`data.html`) и выходные данные (`data.json`).
  - Генерирует запрос для модели Ollama.
  - Извлекает сгенерированные блоки кода и зависимостей.
  - Сохраняет код в `script.py` и зависимости в requirements.txt.
  - Запускает Docker для выполнения скрипта и сравнения результата с ожидаемым.
  - При необходимости запрашивает корректировки у модели.

- **Dockerfile:**  
  Файл для сборки Docker-образа, который устанавливает зависимости и копирует сгенерированный скрипт.

- **data.html и data.json:**  
  Файлы с тестовыми входными и ожидаемыми выходными данными.

## Требования

- Python 3.9 или новее.
- Docker.
- Git (при использовании функции автоматического коммита изменений).
- Модуль `ollama` для взаимодействия с моделью.

## Запуск

Чтобы запустить программу с указанием модели Ollama, используйте следующую команду:
```
python CodeGen.py --model yandex/YandexGPT-5-Lite-8B-instruct-GGUF
```

При запуске программа:
1. Считывает входные данные из data.html и ожидаемый результат из data.json.
2. Отправляет запрос в модель Ollama для генерации кода.
3. Сохраняет полученный код и зависимости в соответствующие файлы.
4. Выполняет сгенерированный код в Docker-контейнере.
5. Сравнивает полученный вывод с ожидаемым результатом и при необходимости запрашивает исправления.
